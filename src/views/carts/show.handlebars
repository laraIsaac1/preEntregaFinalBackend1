<h2>Carrito</h2>

{{#if cart.products.length}}
  <ul>
    {{#each cart.products}}
      <li style="margin-bottom:12px; display:flex; align-items:center; gap:12px;">
        {{#if this.product.thumbnails.[0]}}
          <img src="{{this.product.thumbnails.[0]}}" alt="{{this.product.title}}" style="width:64px; height:64px; object-fit:cover; border-radius:6px;">
        {{/if}}

        <div style="flex:1;">
          <strong>{{this.product.title}}</strong>
          <div style="display:flex; align-items:center; gap:8px; margin-top:4px;">
            <button class="btn ghost"
                    onclick="decreaseQty('{{../cart._id}}','{{this.product._id}}', {{this.quantity}})">–</button>
            <span>Cant: {{this.quantity}}</span>
            <button class="btn ghost"
                    onclick="increaseQty('{{../cart._id}}','{{this.product._id}}', {{this.quantity}})">+</button>
            <span> | Precio: $ {{this.product.price}}</span>
            <span> | Subtotal: <strong>$ {{this.subtotal}}</strong></span>
          </div>
        </div>

        <button class="btn"
                onclick="removeFromCart('{{../cart._id}}','{{this.product._id}}')">
          Eliminar todo
        </button>
      </li>
    {{/each}}
  </ul>

  <hr style="margin:12px 0;">
  <div style="display:flex; justify-content:flex-end; gap:12px; font-size:18px;">
    <span>Total:</span>
    <strong>$ {{total}}</strong>
  </div>

  <div style="margin-top:12px;">
    <button class="btn" onclick="fetch('/api/carts/{{cart._id}}', { method: 'DELETE' }).then(()=>location.reload())">
      Vaciar carrito
    </button>
  </div>
{{else}}
  <p>Tu carrito está vacío.</p>
{{/if}}
